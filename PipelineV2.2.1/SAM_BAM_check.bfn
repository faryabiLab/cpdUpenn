#!/bin/bash
SAM_BAM_check () { sam_bam_file=$1;out_file=$2;if [ `echo $sam_bam_file|grep 'ontarget'|wc -l` == 1 ];then if [ `echo $sam_bam_file|grep 'clipped'|wc -l` == 1 ]; then java -jar /project/cpdlab/Tools/picard/1.46/ValidateSamFile.jar I= $sam_bam_file O= $out_file MODE=SUMMARY IGNORE=INVALID_VERSION_NUMBER IGNORE=MISMATCH_MATE_ALIGNMENT_START IGNORE=MATE_NOT_FOUND; else java -jar /project/cpdlab/Tools/picard/1.46/ValidateSamFile.jar I= $sam_bam_file O= $out_file MODE=SUMMARY IGNORE=MATE_NOT_FOUND IGNORE=INVALID_VERSION_NUMBER; fi elif [ `echo $sam_bam_file|grep 'fixed'|wc -l` == 0 ]; then java -jar /project/cpdlab/Tools/picard/1.46/ValidateSamFile.jar I= $sam_bam_file O= $out_file MODE=SUMMARY IGNORE=MISSING_READ_GROUP; else java -jar /project/cpdlab/Tools/picard/1.46/ValidateSamFile.jar I= $sam_bam_file O= $out_file MODE=SUMMARY IGNORE=INVALID_VERSION_NUMBER; fi; error_detect=`grep 'No errors found' $out_file | wc -l`; if [ $error_detect == 0 ]; then echo $sam_bam_file' is malformed. Terminating the PipeScript..'; exit 64; fi }
